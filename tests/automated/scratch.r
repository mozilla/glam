values <- c(0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 17, 20, 24, 29, 34, 40, 48, 57, 68, 81, 96, 114, 135, 160, 190, 226, 268, 318, 378, 449, 533, 633, 752, 894, 1062, 1262, 1500, 1782, 2117, 2516, 2990, 3553, 4222, 5017, 5961, 7083, 8416, 10000)
weights <- c(0, 0, 0.0323, 0, 0, 0.0087, 0.0011, 0, 0.0206, 0.0038, 0.0312, 0.0186, 0.7143, 4.1478, 10.4717, 17.2563, 25.3303, 38.3811, 43.866, 51.0293, 51.6962, 40.708, 34.4376, 24.5161, 19.5067, 14.829, 10.625, 5.4908, 3.7603, 2.5517, 2.1346, 1.8055, 0.8716, 0.2272, 0.1961, 0.0887, 0.3158, 0.2497, 0.0911, 0.1306, 0.1216, 0.1158, 0.0969, 0.1246, 0.0725, 0.0158, 0.1427, 0.0392, 0.0036, 0.7219)

# this is the correct table
wgt <- wtd.table(values, weights, na.rm=TRUE, normwt=FALSE, type='list')

library('rjson')
sum.of.weights = toJSON(wgt$sum.of.weights)
wgt.values = toJSON(wgt$x)

# this is the important thing
qs <- wtd.quantile(values,weights, probs=c(.05,.25,.5,.75,.95))
# const qs = [29, 48, 68, 96, 190]
